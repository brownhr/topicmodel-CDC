---
title: "Topic Modeling of Twitter Data regarding the CDC and COVID-19"
author: "Harrison Brown"
date: "`r Sys.Date()`"
output:
  bookdown::pdf_document2
toc: yes
header-includes:
- \usepackage{pdflscape}
- \usepackage{dcolumn}
- \usepackage{longtable}
- \usepackage{rotating, graphicx}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
bibliography: references.bib
csl: aag.csl
---

```{=html}
<style>
body{
  text-align: justify
}
</style>
```
```{r setup, include=FALSE}
# source("~/R Projects/5800TwitteR/.Rprofile")

library(dplyr)
library(tidyverse)
library(stargazer)
library(xtable)
library(nnet)
library(kableExtra)

knitr::opts_chunk$set(echo = TRUE)
conversation_wide <- read_rds("conversation_topics_wide.RDS")
conversation_long <- readRDS("conversation_long_2.RDS")
LDA_Summary <- read_csv("LDA_Summary.csv")
mlr <- readRDS("mlr.RDS")

# mlr <- read_rds("mlr.RDS")
conv_nonzero <- conversation_long %>% 
  filter(value > 0)

```

\pagebreak

```{r child="_abstract.Rmd"}

```


\pagebreak

```{r child = "_introduction.Rmd"}

```

\pagebreak

```{r child = "_datacollection.Rmd"}
```

\pagebreak

```{r child = "_methodology.Rmd"}

```


\pagebreak

```{r setfactor, echo = FALSE}
conversation_long$label_CDC <- relevel(conversation_long$label_CDC, ref = "Public-Health")
conversation_long$label_Reply <- relevel(conversation_long$label_Reply, ref = "Public-Health")

```

```{r mlr, include = F, eval = F}
mlr <- conversation_long %>%
  dplyr::filter(
    value > 0
  ) %>% 
  multinom(
  formula = label_Reply ~ label_CDC, 
  weights = value,
  data = .)
```

```{r oddsratio, echo = FALSE}
oddsratio <- exp(coef(mlr)) %>% 
  as.data.frame()
names <- c("Intercept", "Big-Pharma", "COVID-Outbreaks", "COVID-Testing", "Government-Skeptic", "Sanitation", "Masks", "Distancing", "US-Cases", "Vaccine-Effects", "Vaccine-Skeptic")
# colnames(oddsratio) <-  c("Intercept", mlr[["lab"]][-1])
colnames(oddsratio) <- names
oddskable <- knitr::kable(oddsratio, format = "latex", digits = 4,  caption = "Odds Ratios: Reply Topic per CDC Topic", booktabs = T) %>%
  kable_styling(latex_options = c("repeat_header", "scale_down"), font_size = 10) %>% 
  # kableExtra::landscape(margin = "1in")
  add_footnote(notation = "none", label = "CDC Topics by Row; Reply Topics by Column") %>% landscape()
oddskable



```

\pagebreak

# Discussion

# Conclusion

\pagebreak

# References
